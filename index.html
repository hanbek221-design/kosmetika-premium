<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <title>Beauty Store ‚Äî Kosmetika Do‚Äòkoni</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark light">

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    :root{
      --bg:#050816;
      --bg-soft:#0b1021;
      --accent:#ff3e92;
      --accent-soft:#ff8bd0;
      --accent-2:#ffb800;
      --text:#f9fafb;
      --muted:#9ca3af;
      --card:#111827;
      --border-soft:rgba(148,163,184,0.4);
      --danger:#ef4444;
    }
    body.theme-light{
      --bg:#f3f4f6;
      --bg-soft:#e5e7eb;
      --accent:#ec4899;
      --accent-soft:#f9a8d4;
      --accent-2:#f97316;
      --text:#020617;
      --muted:#4b5563;
      --card:#ffffff;
      --border-soft:rgba(148,163,184,0.8);
      --danger:#dc2626;
    }

    body{
      font-family:"Poppins",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:radial-gradient(circle at top,#1e1b4b 0,var(--bg) 45%,var(--bg) 100%);
      color:var(--text);
      min-height:100vh;
      padding-bottom:110px;
    }
    a{text-decoration:none;color:inherit}

    /* HEADER */
    .header{
      position:sticky;top:0;z-index:20;
      backdrop-filter:blur(18px);
      background:linear-gradient(90deg,rgba(15,23,42,0.96),rgba(24,24,27,0.9));
      border-bottom:1px solid var(--border-soft);
      padding:8px 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }
    body.theme-light .header{
      background:linear-gradient(90deg,rgba(249,250,251,0.96),rgba(229,231,235,0.96));
    }
    .logo-wrap{
      display:flex;align-items:center;gap:8px;
    }
    .logo-circle{
      width:32px;height:32px;border-radius:999px;
      background:conic-gradient(from 140deg,#fb7185,#f97316,#ede9fe,#38bdf8,#fb7185);
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 0 18px rgba(248,113,113,0.6);
      font-size:18px;
    }
    .logo-circle span{
      background:#020617;
      padding:2px 7px;
      border-radius:999px;
      font-weight:700;
      font-size:13px;
      color:#f9fafb;
    }
    body.theme-light .logo-circle span{
      background:#f9fafb;
      color:#111827;
    }
    .logo-text{
      display:flex;flex-direction:column;
      line-height:1.1;
    }
    .logo-text strong{font-size:14px;}
    .logo-text small{font-size:10px;color:var(--muted);}
    .header-right{
      display:flex;align-items:center;gap:6px;
    }

    .theme-toggle{
      border:none;
      border-radius:999px;
      padding:5px 8px;
      font-size:14px;
      cursor:pointer;
      background:rgba(15,23,42,0.9);
      color:#e5e7eb;
      display:flex;align-items:center;gap:4px;
    }
    body.theme-light .theme-toggle{
      background:#e5e7eb;
      color:#111827;
    }

    .cart-icon-btn{
      border:none;
      border-radius:999px;
      padding:5px 8px;
      display:flex;
      align-items:center;
      gap:6px;
      cursor:pointer;
      background:radial-gradient(circle at top,#22c55e,#16a34a 50%,#14532d);
      color:#022c22;
      box-shadow:0 6px 16px rgba(34,197,94,0.55);
      font-size:12px;
    }
    .cart-icon-left{
      font-size:18px;
    }
    .cart-icon-info{
      display:flex;
      flex-direction:column;
      align-items:flex-start;
      line-height:1.1;
    }
    .cart-icon-info strong{
      font-size:12px;
    }
    .cart-icon-info small{
      font-size:10px;
      opacity:.9;
    }

    /* HERO */
    .hero{
      padding:10px 12px 4px;
    }
    .hero-title{
      font-size:19px;
      font-weight:700;
    }
    .hero-title span{
      background:linear-gradient(120deg,#f97316,#fb7185,#e879f9);
      -webkit-background-clip:text;
      color:transparent;
    }
    .hero-sub{
      margin-top:4px;
      font-size:11px;
      color:var(--muted);
    }
    .hero-badges{
      margin-top:8px;
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }
    .badge{
      font-size:9px;
      padding:3px 7px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.45);
      background:rgba(15,23,42,0.9);
      display:flex;align-items:center;gap:4px;
      color:#e5e7eb;
    }
    body.theme-light .badge{
      background:#ffffff;
      color:#111827;
    }
    .hero-tag{
      font-size:10px;
      margin-top:8px;
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:4px 8px;
      border-radius:999px;
      background:linear-gradient(90deg,rgba(56,189,248,0.25),rgba(129,140,248,0.15));
      border:1px solid rgba(59,130,246,0.55);
    }
    .hero-note{
      margin-top:6px;
      font-size:10px;
      color:var(--muted);
    }

    /* FILTERS */
    .filters{
      padding:8px 12px 4px;
      display:flex;
      gap:8px;
      overflow-x:auto;
      scrollbar-width:none;
    }
    .filters::-webkit-scrollbar{display:none;}
    .chip{
      flex:0 0 auto;
      font-size:10px;
      padding:5px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.5);
      background:rgba(15,23,42,0.9);
      color:#e5e7eb;
      display:flex;align-items:center;gap:5px;
      cursor:pointer;
      transition:0.18s ease;
      white-space:nowrap;
    }
    body.theme-light .chip{
      background:#ffffff;
      color:#111827;
    }
    .chip.active{
      background:linear-gradient(120deg,#f97316,#ec4899);
      border-color:transparent;
      color:#0f172a;
      font-weight:600;
      box-shadow:0 0 14px rgba(248,113,113,0.4);
    }

    /* PRODUCT GRID */
    .products-wrap{
      padding:6px 8px 80px;
    }
    .products-grid{
      display:grid;
      grid-template-columns:repeat(2,minmax(0,1fr));
      gap:8px;
    }
    @media(min-width:768px){
      .products-grid{grid-template-columns:repeat(4,minmax(0,1fr));}
      body{padding-bottom:110px;}
    }
    .product-card{
      background:linear-gradient(145deg,#020617,var(--card));
      border-radius:14px;
      border:1px solid rgba(31,41,55,0.9);
      padding:7px;
      position:relative;
      overflow:hidden;
      box-shadow:0 10px 22px rgba(0,0,0,0.55);
    }
    body.theme-light .product-card{
      background:#ffffff;
      border-color:rgba(209,213,219,0.9);
      box-shadow:0 10px 24px rgba(148,163,184,0.65);
    }
    .product-top{
      position:relative;
      border-radius:12px;
      padding:8px;
      background:radial-gradient(circle at top,#1d4ed8,#020617 55%);
      overflow:hidden;
    }
    body.theme-light .product-top{
      background:radial-gradient(circle at top,#bfdbfe,#e5e7eb 55%);
    }
    .product-emoji{
      font-size:24px;
    }
    .product-img-tag{
      position:absolute;
      right:6px;top:6px;
      font-size:8px;
      padding:2px 6px;
      border-radius:999px;
      background:rgba(15,23,42,0.9);
      border:1px solid rgba(148,163,184,0.7);
      display:flex;align-items:center;gap:4px;
      color:#e5e7eb;
    }
    body.theme-light .product-img-tag{
      background:#ffffff;
      color:#111827;
    }
    .product-sale{
      position:absolute;
      left:-22px;
      bottom:6px;
      background:linear-gradient(120deg,#f97316,#ec4899);
      padding:2px 24px;
      transform:rotate(-14deg);
      font-size:9px;
      font-weight:700;
      color:#111827;
    }
    .product-body{
      margin-top:5px;
    }
    .product-name{
      font-size:11px;
      font-weight:600;
      min-height:28px;
    }
    .product-meta{
      font-size:9px;
      color:var(--muted);
      margin-top:1px;
    }
    .tag-mini{
      font-size:8px;
      padding:2px 6px;
      border-radius:999px;
      background:rgba(15,23,42,0.9);
      border:1px solid rgba(55,65,81,0.9);
      margin-top:3px;
      display:inline-flex;
      align-items:center;
      gap:4px;
      color:#e5e7eb;
    }
    body.theme-light .tag-mini{
      background:#f9fafb;
      border-color:rgba(209,213,219,0.9);
      color:#111827;
    }
    .price-row{
      margin-top:5px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:6px;
      font-size:11px;
    }
    .price-main{
      font-weight:700;
    }
    .price-old{
      font-size:9px;
      color:var(--muted);
      text-decoration:line-through;
    }
    .btn-add{
      border:none;
      border-radius:999px;
      padding:5px 7px;
      font-size:9px;
      font-weight:600;
      background:linear-gradient(120deg,#22c55e,#16a34a);
      color:#022c22;
      cursor:pointer;
      display:flex;
      align-items:center;
      gap:4px;
      box-shadow:0 6px 12px rgba(34,197,94,0.35);
      flex-shrink:0;
    }
    .btn-add:active{transform:scale(.96);}

    /* BOTTOM ORDER BAR */
    .cart-bar{
      position:fixed;
      bottom:0;left:0;right:0;
      background:radial-gradient(circle at top,#1d2538,#020617 55%);
      border-top:1px solid var(--border-soft);
      padding:8px 10px 10px;
      z-index:30;
      box-shadow:0 -10px 22px rgba(0,0,0,0.75);
    }
    body.theme-light .cart-bar{
      background:radial-gradient(circle at top,#e5e7eb,#f9fafb 55%);
      box-shadow:0 -10px 20px rgba(148,163,184,0.7);
    }
    .cart-bar-note{
      font-size:10px;
      color:var(--muted);
      margin-bottom:4px;
    }
    .cart-main-btn{
      width:100%;
      border:none;
      padding:11px 10px;
      border-radius:999px;
      background:linear-gradient(120deg,#f97316,#ec4899,#8b5cf6);
      color:#020617;
      font-size:14px;
      font-weight:700;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
      cursor:pointer;
      box-shadow:0 9px 24px rgba(236,72,153,0.75);
    }
    .cart-main-btn span.small{
      font-size:10px;
      font-weight:500;
      opacity:.9;
    }

    /* CART SHEET */
    .sheet-overlay{
      position:fixed;
      inset:0;
      background:rgba(15,23,42,0.7);
      opacity:0;
      pointer-events:none;
      transition:opacity .25s ease;
      z-index:35;
    }
    .sheet-overlay.show{
      opacity:1;
      pointer-events:auto;
    }
    .cart-sheet{
      position:fixed;
      left:0;right:0;bottom:0;
      background:var(--bg-soft);
      border-radius:16px 16px 0 0;
      border-top:1px solid var(--border-soft);
      max-height:72vh;
      transform:translateY(100%);
      transition:transform .25s ease;
      z-index:40;
      display:flex;
      flex-direction:column;
    }
    body.theme-light .cart-sheet{
      background:#f9fafb;
    }
    .cart-sheet.open{
      transform:translateY(0);
    }
    .cart-sheet-header{
      padding:8px 12px;
      border-bottom:1px solid var(--border-soft);
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-size:12px;
    }
    .cart-sheet-header h3{
      font-size:13px;
      display:flex;
      align-items:center;
      gap:4px;
    }
    .cart-sheet-header button{
      border:none;
      background:transparent;
      font-size:18px;
      cursor:pointer;
      color:var(--muted);
    }
    .cart-sheet-body{
      padding:6px 12px 4px;
      overflow-y:auto;
      max-height:46vh;
    }
    .cart-sheet-footer{
      padding:8px 12px 10px;
      border-top:1px solid var(--border-soft);
      font-size:12px;
    }
    .cart-sheet-footer-top{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:6px;
    }
    .cart-sheet-footer-top strong{
      font-size:13px;
    }
    .cart-sheet-btn{
      width:100%;
      border:none;
      border-radius:999px;
      padding:10px 10px;
      background:linear-gradient(120deg,#22c55e,#16a34a);
      color:#022c22;
      font-size:13px;
      font-weight:700;
      cursor:pointer;
      box-shadow:0 9px 20px rgba(34,197,94,0.5);
    }
    .cart-empty{
      font-size:11px;
      color:var(--muted);
      text-align:center;
      padding:12px 0;
    }

    .cart-item-row{
      padding:7px 0;
      border-bottom:1px dashed rgba(75,85,99,0.6);
      display:flex;
      flex-direction:column;
      gap:5px;
      font-size:11px;
    }
    .cart-item-main{
      display:flex;
      flex-direction:column;
      gap:1px;
    }
    .cart-item-name{
      font-weight:600;
    }
    .cart-item-meta{
      font-size:10px;
      color:var(--muted);
    }
    .cart-item-actions{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:6px;
      font-size:10px;
    }
    .qty-control{
      display:flex;
      align-items:center;
      border-radius:999px;
      border:1px solid rgba(75,85,99,0.9);
      overflow:hidden;
    }
    .qty-control button{
      border:none;
      background:rgba(15,23,42,0.95);
      color:#e5e7eb;
      width:22px;height:20px;
      cursor:pointer;
      font-size:13px;
    }
    body.theme-light .qty-control button{
      background:#e5e7eb;
      color:#111827;
    }
    .qty-control span{
      padding:0 7px;
      min-width:20px;
      text-align:center;
      font-size:11px;
    }
    .cart-item-total{
      font-weight:600;
    }
    .cart-remove{
      border:none;
      background:transparent;
      color:var(--danger);
      cursor:pointer;
      font-size:16px;
    }
    .cart-edit-label{
      color:var(--danger);
      font-size:10px;
      font-weight:600;
      display:flex;
      align-items:center;
      gap:4px;
      margin-bottom:2px;
    }

    /* TOAST */
    .toast{
      position:fixed;
      left:50%;
      transform:translateX(-50%);
      bottom:95px;
      background:rgba(15,23,42,0.98);
      border-radius:999px;
      padding:6px 12px;
      display:flex;
      align-items:center;
      gap:6px;
      font-size:11px;
      border:1px solid rgba(52,211,153,0.7);
      box-shadow:0 8px 20px rgba(22,163,74,0.75);
      opacity:0;
      pointer-events:none;
      transition:opacity .2s ease,transform .2s ease;
      z-index:50;
    }
    .toast.show{
      opacity:1;
      transform:translate(-50%, -2px);
      pointer-events:auto;
    }
  </style>
</head>

<body>

  <!-- HEADER -->
  <header class="header">
    <div class="logo-wrap">
      <div class="logo-circle">
        <span>B</span>
      </div>
      <div class="logo-text">
        <strong>Beauty Store</strong>
        <small>Premium kosmetika do‚Äòkoni</small>
      </div>
    </div>
    <div class="header-right">
      <button class="theme-toggle" id="themeToggleBtn" type="button">üåô</button>

      <!-- Savat tepada o'ng burchakda -->
      <button class="cart-icon-btn" type="button" onclick="toggleCartSheet(true)">
        <span class="cart-icon-left">üõí</span>
        <div class="cart-icon-info">
          <strong><span id="cartCountTop">0</span> ta</strong>
          <small id="cartTotalTop">0 so‚Äòm</small>
        </div>
      </button>
    </div>
  </header>

  <!-- HERO -->
  <section class="hero">
    <div class="hero-title">
      Har kuni <span>go‚Äòzallik</span> kayfiyati üí´
    </div>
    <p class="hero-sub">
      Pomada, krem, parfyum, niqob va yana ko‚Äòplab mahsulotlar ‚Äî hammasi bitta joyda.
    </p>
    <div class="hero-badges">
      <div class="badge">‚≠ê Original sifat</div>
      <div class="badge">üî• Eng ko‚Äòp sotilganlar</div>
      <div class="badge">üíå Telegram orqali buyurtma</div>
    </div>
    <div class="hero-tag">
      ‚ú® Buyurtmalar <strong>@onatili_premium</strong> ga yuboriladi
    </div>
    <div class="hero-note">
      Buyurtma yuborilgandan keyin faqat telefon raqamingizni yozib qoldiring ‚Äî
      admin sizga tez orada qo‚Äòng‚Äòiroq qiladi.
    </div>
  </section>

  <!-- FILTERS -->
  <div class="filters" id="filterBar">
    <button class="chip active" data-category="all">‚≠ê Barchasi</button>
    <button class="chip" data-category="pomada">üíÑ Pomada</button>
    <button class="chip" data-category="krem">üß¥ Kremlar</button>
    <button class="chip" data-category="parfyum">üå∏ Parfyum</button>
    <button class="chip" data-category="niqob">üò∑ Niqob / Mask</button>
    <button class="chip" data-category="ko‚Äòz">üëÅ Ko‚Äòz uchun</button>
    <button class="chip" data-category="tana">üõÅ Tana parvarishi</button>
  </div>

  <!-- PRODUCTS -->
  <main class="products-wrap">
    <div class="products-grid" id="productsGrid"></div>
  </main>

  <!-- BOTTOM ORDER BAR -->
  <div class="cart-bar">
    <div class="cart-bar-note">
      Savatdagi buyurtmani tahrirlash / o‚Äòchirish uchun tepadagi üõí savat tugmasini bosing.
    </div>
    <button class="cart-main-btn" type="button" onclick="toggleCartSheet(true)">
      <div>
        <div>üì© Buyurtmani Telegramga yuborish</div>
        <span class="small">
          Istalgancha marta yuborish mumkin. Faqat Telegramda telefon raqamingizni yozib qoldiring.
        </span>
      </div>
      <div><span style="font-size:18px;">‚Ä∫</span></div>
    </button>
  </div>

  <!-- CART SHEET -->
  <div class="sheet-overlay" id="cartSheetOverlay" onclick="toggleCartSheet(false)"></div>

  <div class="cart-sheet" id="cartSheet">
    <div class="cart-sheet-header">
      <h3>üõí Savatingiz</h3>
      <button type="button" onclick="toggleCartSheet(false)">‚úï</button>
    </div>
    <div class="cart-sheet-body" id="cartItems"></div>
    <div class="cart-sheet-footer">
      <div class="cart-edit-label">
        üîß Buyurtmani tahrirlash / o‚Äòchirish (qizil tugma orqali)
      </div>
      <div class="cart-sheet-footer-top">
        <span>Umumiy summa:</span>
        <strong id="cartSheetTotal">0 so‚Äòm</strong>
      </div>
      <button class="cart-sheet-btn" type="button" onclick="sendOrder()">
        üì© Telegramga yuborish (@onatili_premium)
      </button>
    </div>
  </div>

  <!-- TOAST -->
  <div class="toast" id="toast">
    ‚úÖ Savatga qo‚Äòshildi
  </div>

<script>
  // Mahsulotlar ro‚Äòyxati
  const products = [
    {name:"Mat pomada Nude Lux", price:89000, oldPrice:109000, category:"pomada", emoji:"üíÑ", tag:"Yangi"},
    {name:"Qizil mat pomada Classic Red", price:99000, oldPrice:119000, category:"pomada", emoji:"üíã", tag:"Best seller"},
    {name:"Lip gloss Shimmer Rose", price:76000, oldPrice:null, category:"pomada", emoji:"‚ú®", tag:"Yaltirroq effekt"},
    {name:"Gialuronli yuz kremi", price:129000, oldPrice:149000, category:"krem", emoji:"üß¥", tag:"Namlik 24 soat"},
    {name:"Kunduzgi SPF 50 krem", price:139000, oldPrice:159000, category:"krem", emoji:"üåû", tag:"SPF qo‚Äòriqlovchi"},
    {name:"Tungi regeneratsion krem", price:155000, oldPrice:179000, category:"krem", emoji:"üåô", tag:"Tungi parvarish"},
    {name:"Gul hidli ayollar parfyumi", price:199000, oldPrice:229000, category:"parfyum", emoji:"üå∏", tag:"Eng ko‚Äòp yoqadigan"},
    {name:"Erkaklar uchun Fresh parfyum", price:189000, oldPrice:219000, category:"parfyum", emoji:"üï∫", tag:"Uzoq saqlanadi"},
    {name:"Unisex Citrus parfyum", price:215000, oldPrice:249000, category:"parfyum", emoji:"üçã", tag:"Citrus hidi"},
    {name:"Ko‚Äòz soyasi palitrasi 16 rang", price:175000, oldPrice:199000, category:"ko‚Äòz", emoji:"üëÅ", tag:"Professional"},
    {name:"Qalam tusuvchi ko‚Äòz layner", price:59000, oldPrice:null, category:"ko‚Äòz", emoji:"‚úèÔ∏è", tag:"Qora klassik"},
    {name:"Hajm beruvchi maskara Volume+", price:97000, oldPrice:119000, category:"ko‚Äòz", emoji:"üéØ", tag:"Juda mashhur"},
    {name:"Qora maska (poralarni tozalovchi)", price:69000, oldPrice:84000, category:"niqob", emoji:"üò∑", tag:"Terlashga qarshi"},
    {name:"Matlashtiruvchi loy niqob", price:73000, oldPrice:null, category:"niqob", emoji:"üß™", tag:"Yog‚Äòli teri uchun"},
    {name:"Namlik beruvchi mato niqob", price:39000, oldPrice:49000, category:"niqob", emoji:"üíß", tag:"1 dona"},
    {name:"Tana uchun shokolad skrab", price:99000, oldPrice:115000, category:"tana", emoji:"üç´", tag:"Yumshoq teri"},
    {name:"Dush geli Coconut Dream", price:67000, oldPrice:null, category:"tana", emoji:"üõÅ", tag:"Kokos hidi"},
    {name:"Qo‚Äòl kremi Almond Care", price:49000, oldPrice:null, category:"tana", emoji:"ü§≤", tag:"Quruq teri uchun"},
    {name:"Sochlar uchun argan yog‚Äòi", price:129000, oldPrice:145000, category:"tana", emoji:"üíÜ‚Äç‚ôÄÔ∏è", tag:"Sochni tiklaydi"},
    {name:"Soch spreyi Heat Protection", price:88000, oldPrice:null, category:"tana", emoji:"üî•", tag:"Fyon uchun"},
    {name:"Brow gel ‚Äî qosh uchun gel", price:64000, oldPrice:null, category:"ko‚Äòz", emoji:"ü™û", tag:"Tartibli qosh"},
    {name:"Make-up bazasi (primer)", price:99000, oldPrice:119000, category:"krem", emoji:"üé®", tag:"Makiyaj uchun baza"},
    {name:"BB krem Natural Finish", price:115000, oldPrice:135000, category:"krem", emoji:"üß¥", tag:"Yengil qoplama"},
    {name:"Ton krem Full Cover", price:159000, oldPrice:179000, category:"krem", emoji:"üß±", tag:"To‚Äòliq qoplama"},
    {name:"Highlighter Glow Stick", price:89000, oldPrice:null, category:"pomada", emoji:"üåü", tag:"Yaltiraydigan"},
    {name:"Blush Peach Cheeks", price:83000, oldPrice:95000, category:"pomada", emoji:"üçë", tag:"Tabiiy rang"},
    {name:"Setting spray 16h", price:99000, oldPrice:119000, category:"krem", emoji:"üí¶", tag:"Makiyajni ushlab turadi"},
    {name:"Mitsellyar suv 400ml", price:69000, oldPrice:null, category:"tana", emoji:"üíß", tag:"Yuzni tozalash"},
    {name:"Yuz uchun peeling kislota", price:119000, oldPrice:139000, category:"krem", emoji:"üß™", tag:"Yangi hujayralar"},
    {name:"Lab balzami Cocoa Care", price:39000, oldPrice:45000, category:"pomada", emoji:"üç´", tag:"Quruq lablar uchun"},
    {name:"Ko‚Äòz atrofidagi krem", price:129000, oldPrice:149000, category:"ko‚Äòz", emoji:"üåô", tag:"Qorong‚Äòi halqalarga"},
    {name:"Antiperspirant roll-on", price:54000, oldPrice:null, category:"tana", emoji:"üßº", tag:"24 soat himoya"},
    {name:"Tana yog‚Äòi Vanilla Kiss", price:99000, oldPrice:115000, category:"tana", emoji:"üß¥", tag:"Vanil hidi"},
    {name:"Keng taroqli soch sh–µ—Ç–∫–∞", price:45000, oldPrice:null, category:"tana", emoji:"ü™Æ", tag:"Sochni uzmaydi"},
    {name:"Make-up cho‚Äòtkalar seti 7 dona", price:139000, oldPrice:159000, category:"tana", emoji:"üñå", tag:"To‚Äòliq to‚Äòplam"},
    {name:"Maskara Waterproof", price:93000, oldPrice:109000, category:"ko‚Äòz", emoji:"üíß", tag:"Suvga chidamli"}
  ];

  const productsGrid = document.getElementById("productsGrid");
  const filterBar = document.getElementById("filterBar");
  const cartCountTopEl = document.getElementById("cartCountTop");
  const cartTotalTopEl = document.getElementById("cartTotalTop");
  const toastEl = document.getElementById("toast");
  const cartSheet = document.getElementById("cartSheet");
  const cartSheetOverlay = document.getElementById("cartSheetOverlay");
  const cartItemsEl = document.getElementById("cartItems");
  const cartSheetTotalEl = document.getElementById("cartSheetTotal");
  const themeToggleBtn = document.getElementById("themeToggleBtn");

  let activeCategory = "all";
  let cart = [];

  function formatPrice(v){
    return v.toLocaleString("uz-UZ");
  }

  function renderProducts(){
    productsGrid.innerHTML = "";
    const filtered = products.filter(p =>
      activeCategory === "all" ? true : p.category === activeCategory
    );
    filtered.forEach(p=>{
      const globalIndex = products.indexOf(p);
      const discount = p.oldPrice ? (100 - Math.round(p.price*100/p.oldPrice)) : null;
      productsGrid.innerHTML += `
        <article class="product-card">
          <div class="product-top">
            <div class="product-emoji">${p.emoji}</div>
            <div class="product-img-tag">
              <span>Beauty</span> <span>Pro</span>
            </div>
            ${discount ? `<div class="product-sale">- ${discount}%</div>` : ``}
          </div>
          <div class="product-body">
            <div class="product-name">${p.name}</div>
            <div class="product-meta">
              ${p.category.toUpperCase()} ‚Ä¢ ${p.tag || "Ommabop mahsulot"}
            </div>
            <div class="tag-mini">
              üí° Tavsiya: ${p.tag || "Har kungi parvarish"}
            </div>
            <div class="price-row">
              <div>
                <div class="price-main">${formatPrice(p.price)} so‚Äòm</div>
                ${p.oldPrice ? `<div class="price-old">${formatPrice(p.oldPrice)} so‚Äòm</div>` : ``}
              </div>
              <button class="btn-add" onclick="addToCart(${globalIndex})">
                ‚ûï Savatga
              </button>
            </div>
          </div>
        </article>
      `;
    });
  }

  // Filter tugmalari
  filterBar.addEventListener("click", (e)=>{
    const btn = e.target.closest(".chip");
    if(!btn) return;
    document.querySelectorAll(".chip").forEach(c=>c.classList.remove("active"));
    btn.classList.add("active");
    activeCategory = btn.dataset.category;
    renderProducts();
  });

  // Savatga qo‚Äòshish
  function addToCart(index){
    const found = cart.find(c => c.index === index);
    if(found){
      found.qty += 1;
    }else{
      cart.push({index, qty:1});
    }
    updateCartUI();
    showToast("‚úÖ Savatga qo‚Äòshildi");
  }

  function updateCartUI(){
    let totalCount = 0;
    let totalPrice = 0;
    cart.forEach(c=>{
      const p = products[c.index];
      totalCount += c.qty;
      totalPrice += p.price * c.qty;
    });
    cartCountTopEl.textContent = totalCount;
    cartTotalTopEl.textContent = formatPrice(totalPrice) + " so‚Äòm";

    if(cartSheet.classList.contains("open")){
      renderCartItems();
    }
  }

  function showToast(message){
    toastEl.textContent = message;
    toastEl.classList.add("show");
    setTimeout(()=> toastEl.classList.remove("show"), 1100);
  }

  // Savat oynasi
  function toggleCartSheet(force){
    const isOpen = cartSheet.classList.contains("open");
    const next = typeof force === "boolean" ? force : !isOpen;
    cartSheet.classList.toggle("open", next);
    cartSheetOverlay.classList.toggle("show", next);
    if(next){
      renderCartItems();
    }
  }

  function renderCartItems(){
    if(cart.length === 0){
      cartItemsEl.innerHTML = "<p class='cart-empty'>Savat hozircha bo‚Äòsh üôÇ</p>";
      cartSheetTotalEl.textContent = "0 so‚Äòm";
      return;
    }
    let html = "";
    let total = 0;
    cart.forEach(c=>{
      const p = products[c.index];
      const lineTotal = p.price * c.qty;
      total += lineTotal;
      html += `
        <div class="cart-item-row">
          <div class="cart-item-main">
            <div class="cart-item-name">${p.name}</div>
            <div class="cart-item-meta">
              ${formatPrice(p.price)} so‚Äòm ‚Ä¢ ${p.category.toUpperCase()}
            </div>
          </div>
          <div class="cart-item-actions">
            <div class="qty-control">
              <button onclick="changeQty(${c.index}, -1)">-</button>
              <span>${c.qty}</span>
              <button onclick="changeQty(${c.index}, 1)">+</button>
            </div>
            <div class="cart-item-total">${formatPrice(lineTotal)} so‚Äòm</div>
            <button class="cart-remove" onclick="removeFromCart(${c.index})">‚úï</button>
          </div>
        </div>
      `;
    });
    cartItemsEl.innerHTML = html;
    cartSheetTotalEl.textContent = formatPrice(total) + " so‚Äòm";
  }

  function changeQty(productIndex, delta){
    const item = cart.find(c => c.index === productIndex);
    if(!item) return;
    item.qty += delta;
    if(item.qty <= 0){
      cart = cart.filter(c=>c.index !== productIndex);
    }
    updateCartUI();
    renderCartItems();
  }

  function removeFromCart(productIndex){
    cart = cart.filter(c=>c.index !== productIndex);
    updateCartUI();
    renderCartItems();
  }

  // Telegramga ochish (WebApp uchun mos / brauzer uchun alohida)
  function openTelegramLink(url){
    const tg = window.Telegram && window.Telegram.WebApp;
    if(tg){
      tg.openTelegramLink(url); // WebApp ichida
    }else{
      window.open(url, "_blank"); // brauzerda yangi tab, sayt yopilmaydi
    }
  }

  // Telegramga yuborish ‚Äî istalgancha marta mumkin
  function sendOrder(){
    if(cart.length === 0){
      showToast("Savat bo‚Äòsh. Avval mahsulot tanlang üôÇ");
      return;
    }
    let text = "Assalomu alaykum. Men quyidagi kosmetika mahsulotlarini buyurtma qilmoqchiman:\n\n";
    let totalPrice = 0;
    cart.forEach((c, i)=>{
      const p = products[c.index];
      const lineTotal = p.price * c.qty;
      totalPrice += lineTotal;
      text += (i+1) + ") " + p.name + " ‚Äî " + c.qty + " dona ‚Äî " + formatPrice(lineTotal) + " so‚Äòm\n";
    });
    text += "\nUmumiy summa: " + formatPrice(totalPrice) + " so‚Äòm\n";
    text += "\nFaqat telefon raqamimni yozib qoldiraman, admin menga tez orada qo‚Äòng‚Äòiroq qiladi.";

    const encoded = encodeURIComponent(text);
    // Har safar URL oxiriga unique parametr qo‚Äòshamiz ‚Äî qayta-qayta yuborilaversin
    const url = "https://t.me/onatili_premium?text=" + encoded + "&t=" + Date.now();

    openTelegramLink(url);
    showToast("‚úÖ Buyurtma yuborildi. Telefon raqamingizni yozib qoldiring.");
  }

  // Tema (dark / light)
  const THEME_KEY = "beauty_theme";

  function applyTheme(theme){
    document.body.classList.toggle("theme-light", theme === "light");
    themeToggleBtn.textContent = theme === "light" ? "üåô" : "‚òÄÔ∏è";
  }

  function toggleTheme(){
    const current = localStorage.getItem(THEME_KEY) || "dark";
    const next = current === "dark" ? "light" : "dark";
    localStorage.setItem(THEME_KEY, next);
    applyTheme(next);
  }

  themeToggleBtn.addEventListener("click", toggleTheme);

  // Dastlabki init
  (function init(){
    const savedTheme = localStorage.getItem(THEME_KEY) || "dark";
    applyTheme(savedTheme);
    renderProducts();
  })();

  // Global funksiyalar
  window.addToCart = addToCart;
  window.toggleCartSheet = toggleCartSheet;
  window.changeQty = changeQty;
  window.removeFromCart = removeFromCart;
  window.sendOrder = sendOrder;
</script>

</body>
</html>
